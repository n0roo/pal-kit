# Core 에이전트 공통 컨벤션

> 모든 Core 에이전트가 준수해야 하는 공통 규칙

---

## 1. 기본 원칙

### 1.1 사용자 승인 우선

- 주요 결정 전 반드시 사용자 확인
- 대규모 변경 전 요약 및 승인 요청
- 불확실한 요구사항은 명확화 후 진행

### 1.2 단계별 진행

- 한 번에 하나의 작업에 집중
- 각 단계 완료 후 다음 단계 진행
- 중간 결과물 검증 후 진행

### 1.3 명확한 출력

- 정해진 산출물 형식 준수
- 마크다운 포맷 사용
- 체크리스트로 진행 상황 표시

---

## 2. 역할 전환 규칙

### 2.1 전환 조건

```
현재 역할 작업 완료 → 전환 가능
├── 체크리스트 100% 완료
├── 산출물 생성 완료
└── 사용자 승인 완료 (필요시)
```

### 2.2 전환 프로토콜

1. 현재 역할 작업 완료 선언
2. 사용자에게 전환 알림
3. 이전 작업 요약 전달 (컨텍스트)
4. 새 역할 시작

### 2.3 컨텍스트 전달

전환 시 다음 역할에 전달할 정보:
- 완료된 작업 요약
- 생성된 산출물 경로
- 주요 결정 사항
- 다음 작업 권장 사항

---

## 3. 에스컬레이션 규칙

### 3.1 에스컬레이션 기준

| 상황 | 대상 | 조치 |
|------|------|------|
| 포트 범위 초과 작업 | Manager/User | 새 포트 생성 제안 |
| 아키텍처 변경 필요 | Architect | 아키텍처 검토 요청 |
| 기술적 결정 필요 | Architect/User | 결정 요청 |
| 의존성 충돌 | Builder/Architect | 의존성 재조정 |
| 예상치 못한 복잡도 | Manager/User | 작업 분할 제안 |
| 컨벤션 위반 불가피 | Architect/User | 예외 승인 요청 |

### 3.2 에스컬레이션 형식

```markdown
## 에스컬레이션

**유형**: [범위초과 | 아키텍처 | 기술결정 | 의존성 | 복잡도 | 컨벤션]
**현재 작업**: {작업 설명}
**문제**: {문제 상세}
**제안**: {해결 제안}
**영향**: {영향 범위}
```

### 3.3 에스컬레이션 후 처리

- 에스컬레이션 발생 시 현재 작업 일시 중지
- 해결 후 작업 재개
- 해결 내용 문서화

---

## 4. 완료 체크리스트 표준

### 4.1 체크리스트 구조

```markdown
## 완료 체크리스트

### 필수 항목
- [ ] {필수 항목 1}
- [ ] {필수 항목 2}
- [ ] {필수 항목 3}

### 선택 항목
- [ ] {선택 항목 1} (조건: ...)
- [ ] {선택 항목 2} (조건: ...)

### 검증
- [ ] 사용자 승인
```

### 4.2 체크리스트 규칙

- 필수 항목 100% 완료 필수
- 선택 항목은 조건 충족 시 수행
- 모든 항목 체크 후에만 완료 선언
- 체크 불가 항목은 사유와 함께 에스컬레이션

### 4.3 공통 완료 항목

모든 Core 에이전트 공통:
- [ ] 포트 명세 요구사항 충족
- [ ] 산출물 생성 완료
- [ ] 컨벤션 준수 확인
- [ ] 에스컬레이션 없음 (또는 해결됨)

---

## 5. 통신 규칙

### 5.1 상태 보고

작업 중 주기적으로 상태 보고:
```markdown
### 진행 상황
- 완료: {완료 항목}
- 진행 중: {현재 작업}
- 대기: {남은 작업}
```

### 5.2 산출물 보고

산출물 생성 시:
```markdown
### 산출물 생성
- 파일: {경로}
- 내용: {요약}
- 다음: {후속 작업}
```

### 5.3 질문 형식

명확화가 필요할 때:
```markdown
### 확인 요청
**배경**: {상황 설명}
**질문**: {구체적 질문}
**옵션** (있는 경우):
1. {옵션 1} - {장단점}
2. {옵션 2} - {장단점}
```

---

## 6. PAL Kit 명령어 사용

### 6.1 공통 명령어

```bash
# 상태 확인
pal status

# 포트 목록
pal port list

# 포트 상세
pal port show <id>

# 세션 목록
pal session list
```

### 6.2 명령어 사용 원칙

- 상태 확인 후 작업 시작
- 명령어 실행 결과 확인
- 오류 발생 시 에스컬레이션

---

## 7. 문서화 규칙

### 7.1 마크다운 형식

- 헤딩은 계층적으로 사용 (#, ##, ###)
- 코드 블록에 언어 명시
- 테이블로 구조화된 정보 표현
- 체크리스트로 진행 상황 표시

### 7.2 파일 네이밍

- 소문자, 하이픈 구분
- 의미 있는 이름
- 예: `agent-analysis.md`, `port-checkout.md`

---

<!-- pal:convention:core:common -->
